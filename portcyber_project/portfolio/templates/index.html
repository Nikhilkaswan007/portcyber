{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NK - Digital Operations Console</title>
    <link rel="stylesheet" href="{% static 'css/theme.css' %}">
</head>
<body>
    <!-- Three.js Background -->
    <div id="three-background"></div>
    
    <!-- Scanline Effect -->
    <div class="scanline"></div>
    
    <!-- Noise/Glitch Overlay -->
    <div class="glitch-overlay"></div>
    
    <!-- Boot Sequence -->
    <div id="boot-screen" class="boot-screen active">
        <div class="boot-content">
            <div class="boot-line boot-line-1">SYSTEM INITIALIZATION...</div>
            <div class="boot-line boot-line-2">LOADING DIGITAL OPERATIONS CONSOLE</div>
            <div class="boot-line boot-line-3">AUTHENTICATING USER...</div>
            <div class="boot-line boot-line-4">NK SYSTEM ONLINE</div>
            <div class="boot-line boot-line-5">PRESS ENTER OR CLICK TO CONTINUE</div>
            <div class="boot-cursor"></div>
        </div>
    </div>

    <!-- Main System Interface (Hidden until boot complete) -->
    <div id="system-interface" class="system-interface" style="display: none;">
        <!-- Header / Status Bar -->
        <div class="header">
            <div class="level-info">
                <div class="level"><span class="level-badge" id="level-display">{{ level }}</span> LEVEL</div>
                <div class="coins">
                    <span style="margin-right: 5px;">+</span>
                    <span id="coins-display">{{ coins }}</span>
                    <span style="margin-left: 5px; font-size: 12px;">COINS AWARDED</span>
                </div>
            </div>
            <div class="header-controls">
                <div class="setting-btn mobile-profile-btn" id="mobile-profile-btn" title="Profile" onclick="openMobileProfileModal()" style="display: none;">üë§</div>
                <div class="setting-btn" id="sound-fx" title="Sound Effects" onclick="toggleSetting('sound')">üîä</div>
                <div class="setting-btn" id="music" title="Music" onclick="toggleSetting('music')">üéµ</div>
                <div class="setting-btn" id="visual-settings" title="Visual Settings" onclick="toggleSetting('visuals')">‚öôÔ∏è</div>
                <div class="setting-btn" id="accessibility" title="Accessibility" onclick="openAccessibilityPanel()">‚ôø</div>
            </div>
            <div class="time-info">
                <div>CREDITS</div>
                <div>SERVER TIME: <span id="server-time">--:--</span></div>
                <div>LOCAL TIME: <span id="local-time">--:--</span></div>
            </div>
        </div>

        <!-- Sidebar / Profile Panel -->
        <div class="sidebar">
            <div class="profile-img">
                <img src="https://via.placeholder.com/150/ff3366/000000?text=NK" alt="Profile">
            </div>
            <div class="profile-info">
                <div class="profile-name">{{ profile_name }}</div>
                <div class="profile-title">{{ profile_title }}</div>
                <div class="profile-company">{{ company }}</div>
                <div class="profile-status">
                    <div class="status-icon"></div>
                    <span>OPEN FOR HIRE</span>
                </div>
            </div>
            <a href="#" class="social-btn" onclick="systemCommand('connect'); return false;">
                <span>üîó</span>
                <span>OPEN CONNECTION</span>
            </a>
            <div class="motto">
                CODE IS ART<br>
                DESIGN IS FUNCTION<br>
                SYSTEMS ARE ALIVE.
            </div>
        </div>

        <!-- Main Content Area -->
        <div class="main-content" id="main-content">
            <!-- Content will be loaded here dynamically -->
        </div>

        <!-- Content Loader (Always present, overlays main-content when active) -->
        <div class="content-loader" id="content-loader" style="display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 10;">
            <div class="loader-spinner"></div>
            <div class="loader-text">SYSTEM_LOAD</div>
        </div>

        <!-- Navigation Tabs (Dynamic) -->
        <div class="nav-tabs" id="nav-tabs"></div>

        <!-- System Message Area -->
        <div class="system-message" id="system-message"></div>

        <!-- Quest Panel -->
        <div class="quest-panel" id="quest-panel">
            <div class="quest-header">
                <div class="quest-title">ACTIVE QUEST</div>
                <div class="quest-close" onclick="closeQuestPanel()">‚úï</div>
            </div>
            <div class="quest-content" id="quest-content">
                <div style="font-size: 9px; color: #666; margin-bottom: 10px;">NAVIGATION SYSTEM</div>
                <div class="quest-name">EXPLORE THE INTERFACE</div>
                <div class="quest-goal">
                    <strong>GOAL</strong><br>
                    NAVIGATE THROUGH SECTIONS AND INTERACT WITH THE SYSTEM.
                </div>
                <div class="quest-rewards">
                    <div class="reward-badge">
                        <div class="reward-icon">üèÜ</div>
                        <div class="reward-text">+5</div>
                    </div>
                    <div class="reward-badge">
                        <div class="reward-icon">üí∞</div>
                        <div class="reward-text">+25</div>
                    </div>
                </div>
            </div>
        </div>



        <!-- Accessibility / Settings Modal -->
        <div class="modal-overlay" id="accessibility-modal" style="display: none;">
            <div class="modal-content settings-modal">
                <div class="modal-close" onclick="closeAccessibilityPanel()">‚úï</div>
                <div class="modal-header">
                    <h2>SYSTEM SETTINGS</h2>
                </div>
                <div class="modal-body">
                    <div class="settings-section">
                        <label class="setting-label">Visual Intensity</label>
                        <input type="range" id="visual-intensity" min="0" max="100" value="100" onchange="updateVisualIntensity(this.value)">
                        <span id="visual-intensity-display">100%</span>
                    </div>
                    <div class="settings-section">
                        <label class="setting-label">Background Motion</label>
                        <input type="range" id="motion-level" min="0" max="100" value="100" onchange="updateMotionLevel(this.value)">
                        <span id="motion-level-display">100%</span>
                    </div>
                    <div class="settings-section">
                        <label class="setting-label">Noise/Grain</label>
                        <input type="range" id="noise-level" min="0" max="100" value="100" onchange="updateNoiseLevel(this.value)">
                        <span id="noise-level-display">100%</span>
                    </div>
                    <div class="settings-section">
                        <label class="setting-label">Interface Contrast</label>
                        <input type="range" id="contrast-level" min="50" max="150" value="100" onchange="updateContrast(this.value)">
                        <span id="contrast-level-display">100%</span>
                    </div>
                    <div class="settings-section checkbox">
                        <label>
                            <input type="checkbox" id="performance-mode" onchange="togglePerformanceMode()">
                            Performance Mode (reduce background complexity)
                        </label>
                    </div>
                    <div class="settings-section checkbox">
                        <label>
                            <input type="checkbox" id="reduce-motion" onchange="toggleReduceMotion()">
                            Reduce Motion (accessibility)
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal for Viewers (Creations, etc) -->
        <div class="modal-overlay" id="viewer-modal" style="display: none;">
            <div class="modal-content viewer-modal">
                <div class="modal-close" onclick="closeViewer()">‚úï</div>
                <div class="viewer-content" id="viewer-content"></div>
            </div>
        </div>

        <!-- Mobile Profile Modal -->
        <div class="modal-overlay" id="mobile-profile-modal" style="display: none;">
            <div class="modal-content mobile-profile-modal-content">
                <div class="modal-close" onclick="closeMobileProfileModal()">‚úï</div>
                <div class="profile-modal-body">
                    <img src="https://via.placeholder.com/200/ff3366/000000?text=NK" alt="Profile" class="profile-modal-img">
                    <div class="profile-modal-name">{{ profile_name }}</div>
                    <div class="profile-modal-title">{{ profile_title }}</div>
                    <div class="profile-modal-company">{{ company }}</div>
                    <div class="profile-modal-status">
                        <span style="width: 10px; height: 10px; background: #ff3366; border-radius: 50%; animation: pulse 2s infinite;"></span>
                        <span>OPEN FOR HIRE</span>
                    </div>
                    <div class="profile-modal-motto">
                        CODE IS ART<br>
                        DESIGN IS FUNCTION<br>
                        SYSTEMS ARE ALIVE.
                    </div>
                    <a href="#" class="social-btn" onclick="systemCommand('connect'); closeMobileProfileModal(); return false;">
                        <span>üîó</span>
                        <span>OPEN CONNECTION</span>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    <script src="{% static 'js/system-state.js' %}"></script>
    <script src="{% static 'js/boot.js' %}"></script>
    <script src="{% static 'js/navigation.js' %}"></script>
    <script src="{% static 'js/three-background.js' %}"></script>
    <script src="{% static 'js/settings.js' %}"></script>
    <script src="{% static 'js/system-feedback.js' %}"></script>
    <script src="{% static 'js/interactions.js' %}"></script>
</body>
</html>
